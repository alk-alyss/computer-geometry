% \documentclass[draft]{article}
\documentclass{article}

\usepackage[
	backend=biber,
	style=alphabetic,
	sorting=ynt
]{biblatex}
\addbibresource{resources.bib}

\usepackage[greek]{babel}

\usepackage[a4paper, margin=1.10in]{geometry}

\usepackage{graphicx}
\graphicspath{ {./images} }
\usepackage{amsmath}
\usepackage{subcaption}

\usepackage{fontspec}
\setmainfont{DejaVuSansM Nerd Font}
\setsansfont{DejaVuSansM Nerd Font}

\title{Project 4: Spectral Mesh Processing}
\author{Αλκίνοος Αλυσσανδράκης 1072752}
\date{}

\begin{document}

\maketitle

\vfill
\tableofcontents
\vfill
\newpage

\section{Σκοπός της εργασίας}
Η παρούσα εργασία έχει ως σκοπό την εξερεύνηση μεθόδων για την ανάλυση ενός τρισδιάστατου
μοντέλου με βάση τις συχνοτικές του ιδιότητες και ύστερα την επεξεργασία του
μοντέλου χρησιμοποιώντας τις ιδιότητες αυτές. Στην πρώτη φάση της ανάλυσης θα
χρησιμοποιηθούν τεχνικές όπως η εύρεση του Laplacian Matrix του μοντέλου, η ανάλυση
ιδιοδιανυσμάτων αυτού του πίνακα και η οπτικοποίηση των αποτελεσμάτων, προκειμένου να
βρεθούν και να αναδειχθούν οι συχνοτικές συνιστώσες που αποτελούν το μοντέλο. Ύστερα,
αφού πρώτα προστεθεί τεχνητός θόρυβος στο μοντέλο, θα γίνει εξομάλυνση (smoothing) του
μοντέλου, χρησιμοποιώντας τις συνιστώσες που βρέθηκαν προηγουμένως, με την τεχνική της
αφαίρεσης των υψίσυχνων συνιστωσών του μοντέλου. Τέλος, εκτελώντας την ίδια διαδικασία
ανάλυσης σε πολλά μοντέλα, θα χρησιμοποιηθούν οι χαμηλόσυχνες και υψίσυχνες συνιστώσες
κάθε μοντέλου προκειμένου να βρεθούν μοντέλα με όμοια σχήματα και όμοιες επιφανειακές
λεπτομέρειες αντίστοιχα.

\section{Συχνοτική Ανάλυση}
Στον κλάδο της ανάλυσης σημάτων πολλές φορές δεν είναι πρακτικό η ανάλυση να γίνει στο
πεδίο του χρόνου. Για αυτό τον λόγο χρησιμοποιείται η τεχνική του μετασχηματισμού
Fourier προκειμένου το σήμα να μεταφερθεί από το πεδίο του χρόνου στο πεδίο της
συχνότητας. Ετσί αναδεικνύονται ιδιότητες του σήματος που προηγουμένως δεν ήταν εμφανείς
και η ανάλυση γίνεται πιο εύκολη. Αντίστοιχα στον κλάδο της υπολογιστικής γεωμετρίας
είναι δυνατόν σε ένα μοντέλο να γίνει συχνοτική ανάλυση με μια διαδικασία παρόμοια του
μετασχηματισμού Fourier, έτσι ώστε κάποιες διαδικασίες ανάλυσης και επεξεργασίας του
μοντέλου να καθιστούν πιο απλές και κυρίως να μειωθεί ο υπολογιστικός φόρτος που
απαιτήται για να πραγματοποιηθούν.

\subsection{Laplacian Matrix}
Πρώτο βήμα στη συχνοτική ανάλυση ενός μοντέλου είναι η εύρεση του πίνακα Laplace. Πάνω
στον πίνακα αυτό είναι που θα πραγματοποιηθεί ανάλυση ιδιοδιανυσμάτων για να προκύψουν οι
συχνοτικές συνιστώσες. Αυτή η διαδικασία μπορεί να παρομοιαστεί με τον μετασχηματισμό
Fourier που χρησιμοποιείται στην ανάλυση σημάτων, με την έννοια ότι και στις δύο
περιπτώσεις τα δεδομένα μετασχηματίζονται από το το πεδίο του χώρου και του χρόνου
αντίστοιχα, στο πεδίο της συχνότητας

Ο Laplacian Matrix μπορεί να υπολογιστεί με διάφορους τρόπους.
Υπάρχουν δύο βασικές κατηγορίες,
αυτοί που υπολογίζονται με βάση μόνο τη συνδεσιμότητα των κορυφών του μοντέλου,
οι οποίου ονομάζονται συνδυαστικοί (combinatorial),
και αυτοί που στον υπολογισμό τους λαμβάνεται υπ' όψη και η γεωμετρία του μοντέλου,
δηλαδή η θέση των κορυφών και όχι μόνο πως συνδέονται,
οι οποίοι ονομάζονται γεωμετρικοί (geometric).

Σε αυτή την εργασία έχουν χρησιμοποιηθεί δύο μέθοδοι για την εύρεση του Laplacian Matrix
που βρίσκονται και οι δύο στην κατηγορία των combinatorial.
Είναι οι Graph Laplacian Matrix και Tutte Laplacian Matrix

\subsubsection{Graph Laplacian Matrix}
Για τον υπολογισμό του Graph Laplacian χρειάζονται δύο άλλοι πίνακες:
\begin{enumerate}
	\item Adjacency Matrix που ορίζεται ως
		\[
			A_{ij} = \begin{cases}
				1 \quad if \; (i, j) \in E \\
				0 \quad otherwise
			\end{cases}
		\]

		όπου δηλαδή σε για κάθε κορυφή $i, j$ αν υπάρχει ακμή μεταξύ τους
		(αν το ζεύγος $(i,j)$ βρήσκεται στο σύνολο $E$ των ακμών)
		τότε στις θέσεις $[i, j]$ και $[j, i]$ του πίνακα Α τοποθετείται ο αριθμός 1,
		αλλιώς τοποθετείται ο αριθμός 0

	\item Degree Matrix που ορίζεται ως
		\[
			D_{ij} = \begin{cases}
				N(i) \quad if \ i=j \\
				0 \quad otherwise
			\end{cases}
		\]

		όπου $N(i)$ ο αριθμός των κορυφών με τους οποίους γειτονεύει η κορυφή $i$
\end{enumerate}

\noindent
Έχοντας τους δύο συστατικούς πίνακες εν τέλει ο Laplacian πίνακας ορίζεται ως:

\[
	L = D - A
\]

\subsubsection{Tutte Laplacian Matrix}
Ο Tutte Laplacian Matrix ορίζεται παρόμοια με τον Graph Laplacian
λόγω του ότι χρησιμοποιεί και αυτός τους πίνακες Adjacency και Degree,
αλλά ο τελικός τύπος είναι:

\[
	L = D^{-1}A
\]

\subsection{Ανάλυση Ιδιοδιανυσμάτων}
Το επόμενο βήμα στη συχνοτική ανάλυση είναι να πάρουμε τον Laplacian Matrix,
όπως αυτός ορίστηκε πιο πάνω και να εκτελέσουμε σε αυτόν ανάλυση ιδιοδιανυσμάτων.
Δηλαδή θέλουμε να βρούμε τις ιδιοτιμές αυτού του πίνακα και τα αντίστοιχα ιδιοδιανύσματα.

Στη συνέχεια ταξινομούμε αυτά τα ζευγάρια με βάση την ιδιοτιμή σε αύξουσα σειρά,
οπότε λέμε ότι για τις μικρές ιδιοτιμές τα ιδιοδιανύσματα είναι οι χαμηλόσυχνες
συνιστώσες του μοντέλου,
ενώ για τις μεγάλες ιδιοτιμές τα ιδιοδιανύσματα είναι οι υψίσυχνες συνιστώσες του μοντέλου.
Τα πρώτα είναι υπεύθυνα για τον σχηματισμό του γενικότερου σχήματος του μοντέλου
(π.χ. αν το μοντέλο είναι ένα άλογο, τότε από τις χαμηλές ιδιοτιμές σχηματίζονται το
σώμα, το κεφάλι και τα πόδια), ενώ τα δεύτερα είναι υπεύθυνα για τις λεπτομέρειες στην
επιφάνεια του μοντέλου (π.χ. τα ρουθούνια στο κεφάλι του αλόγου,
ή αν είναι αρκετά μεγάλη η ανάλυση, η υφή του δέρματος).

\subsection{Οπτικοποίηση Ιδιοδιανυσμάτων}
Κάθε ιδιοδιάνυσμα που προκύπτει από τη συχνοτική ανάλυση επηρεάζει με διαφορετικό τρόπο
τις κορυφές του μοντέλου. Η επιρροή ενός ιδιοδιανύσματος μπορεί να την οπτικοποιηθεί
χρησιμοποιώντας τις συνιστώσες του. Επειδή το πλήθος των συνιστώσεων είναι ίσο με το
πλήθος των κορυφών του μοντέλου, κάθε συνιστώσα αντιστοιχεί σε μια κορυφή.
Άρα πραγματοποιήται κανονικοποίηση των συνιστωσών, έτσι ώστε όλες οι συνιστώσες να
βρίσκονται στο διάστημα [0,1] και σε κάθε τιμή αντιστοιχίζεται ένα χρώμα
από μια γραμμική κλίμακα χρωμάτων (colour gradient). Το τελικό αποτέλεσμα φαίνεται στο
Σχήμα \ref{fig:visualization}

\begin{figure}[h]
	\centering
	\begin{subfigure}{0.45\textwidth}
		\includegraphics[width=\textwidth]{"vl_freq.png"}
		\caption{Πολύ χαμηλόσυχνα ιδιοδιανύσματα}
		\label{fig:vis1}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\includegraphics[width=\textwidth]{"l_freq.png"}
		\caption{Χαμηλόσυχνα ιδιοδιανύσματα}
		\label{fig:vis2}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\includegraphics[width=\textwidth]{"h_freq.png"}
		\caption{Υψίσυχνα ιδιοδιανύσματα}
		\label{fig:vis3}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\includegraphics[width=\textwidth]{"vh_freq.png"}
		\caption{Πολύ υψίσυχνα ιδιοδιανύσματα}
		\label{fig:vis4}
	\end{subfigure}
	\caption{Οπτικοποίηση της επιρροής των ιδιοδιανυσμάτων στο μοντέλο}
	\label{fig:visualization}
\end{figure}

Στην οπτικοποίηση των ιδιοδιανυσμάτων παρατηρείται η δημιουργία μοτίβων στα χρώματα.
Μέσω αυτών των μοτίβων αναδυκνύεται η αρμονική συμπεριφορά των ιδιοδιανυσμάτων, αφού τα
χρώματα δεν αλλάζουν απότομα αλλά με ημιτονοειδή τρόπο. Φαίνεται επίσης η αναλογία
των ιδιοδιανυσμάτων με τη συχνότητα, αφού στα πιο χαμηλόσυχνα ιδιοδιανύσματα
τα μοτίβα που δημιουργούνται καλύπτουν μεγάλες περιοχές του μοντέλου, άρα μπορούμε
να πούμε ότι παρουσιάζουν μικρή λεπτομέρεια. Αντιθέτως στα υψίσυχνα ιδιοδιανύσματα τα μοτίβα
καλύπτουν μικρότερες περιοχές, άρα μπορούμε να πούμε ότι παρουσιάζουν μεγάλη λεπτομέρεια.
Η παρατήρηση αυτή ενισχύει το επιχείρημα ότι τα χαμηλόσυχνα ιδιοδιανύσματα ευθύνονται για
το γενικότερο σχήμα του μοντέλου, ενώ τα υψίσυχνα για τις λεπτομέρειες.


\section{Προσθήκη θορύβου}
Για να λειτουργήσει το επόμενο βήμα της εξομάλυνσης του μοντέλου,
είναι απαραίτητο πρώτα να προστεθεί στο μοντέλο κάποιου είδους θορύβου.
Έτσι είναι δυνατόν να γίνει σύγκριση ανάμεσα στο αρχικό μοντέλο,
το θορυβώδες μοντέλο και το τελικό εξομαλυμμένο μοντέλο.

Για τους σκοπούς της εργασίας έχουν χρησιμοποιηθεί δύο αλγόριθμοι
δημιουργίας θορύβου, οι Gaussian noise και Perlin noise.
Σε κάθε περίπτωση το αποτέλεσμα του θορύβου έχει εφαρμοστεί στο
μοντέλο με την εξής διαδικασία για κάθε κορυφή:

\begin{itemize}
	\item Δημιουργία ψευδοτυχαίου αριθμού με βάση κάποιο αλγόριθμο θορύβου
	\item Εύρεση του καθέτου διανύσματος της κορυφής σε σχέση με το υπόλοιπο μοντέλο
	\item Δημιουργία ενός διανύσματος, με βάση την τυχαία τιμή που αντιστοιχεί στην
		κορυφή, παράλληλο στο κάθετο διάνυσμα της κορυφής
	\item Προσθήκη του νέου διανύσματος στο κάθετο διάνυσμα της κορυφής,
		πολλαπλασιασμένο κατά ένα παράγοντα (noise factor),
		που καθορίζει πόσο να επηρεαστεί το μοντέλο από τον θόρυβο
\end{itemize}

Το αποτέλεσμα αυτής της διαδικασίας είναι το μοντέλο να αποκτήσει μια τραχύτητα στην
επιφάνειά του, χωρίς όμως να έχουν προστεθεί παραπάνω κορυφές

\begin{figure}[h]
	\centering
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"original_model.png"}
		\caption{Αρχικό μοντέλο}
	\end{subfigure}
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"gaussian_noise.png"}
		\caption{Μοντέλο με Gaussian Noise}
	\end{subfigure}
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"perlin_noise.png"}
		\caption{Μοντέλο με Perlin Noise}
	\end{subfigure}
	\caption{Παράδειγμα εφαρμογής Θορύβου σε μοντέλο}
	\label{fig:noise}
\end{figure}

\section{Εξομάλυνση μοντέλου}
\label{smoothing}
Η βασική ιδέα για την εξομάλυνση του μοντέλου είναι αρκετά απλή. Η τραχύτητα που
προστέθηκε στο μοντέλο με τον θόρυβο επηρεάζει κυρίως τις επιφανειακές λεπτομέρειες
του μοντέλου - τα οποία χαρακτηριστικά επηρεάζονται από τις υψίσυχνες συνιστώσες -
ενώ το βασικό σχήμα παραμένει το ίδιο. Οπότε μπορούμε να χρησιμοποιήσουμε μόνο τα
χαμηλόσυχνα ιδιοδιανύσματα για να μετασχηματίσουμε το μοντέλο στο πεδίο της συχνότητας και
πάλι πίσω στο πεδίο του χώρου. Με αυτόν τον τρόπο εξαλείφουμε την επιρροή των υψίσυχνων
ιδιοδιανυσμάτων και άρα αφαιρούμε τον θόρυβο από το μοντέλο

Ο μετασχηματισμός των κορυφών του μοντέλου γίνεται με τον τύπο

\[
	V' = UU^TV
\]

όπου:
\begin{itemize}
	\item $V$ ο πίνακας με τις αρχικές θέσεις των κορυφών
	\item $V'$ ο πίνακας με τις τελικές θέσεις των κορυφών
	\item $U$ ο πίνακας με τα επιλεγμένα ιδιοδιανύσματα
		(στην προκειμένη περίπτωση τα χαμηλόσυχνα)
\end{itemize}

\begin{figure}[h]
	\centering
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"250_eigs.png"}
		\caption{Εξομαλυνμένο μοντέλο (χρήση 250 ιδιοδιανυσμάτων)}
	\end{subfigure}
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"1000_eigs.png"}
		\caption{Εξομαλυνμένο μοντέλο (χρήση 1000 ιδιοδιανυσμάτων)}
	\end{subfigure}
	\begin{subfigure}{0.4\textwidth}
		\includegraphics[width=\textwidth]{"noisy_mesh.png"}
		\caption{Θορυβώδες μοντέλο}
	\end{subfigure}
	\caption{Παράδειγμα εξομαλυνσης μοντέλου}
	\label{fig:simplify}
\end{figure}

Όπως φαίνεται στο Σχήμα \ref{fig:simplify}, η εξομάλυνση δεν είναι τέλεια
(τουλάχιστον όταν χρησιμοποιούνται λίγα ιδιοδιανύσματα), αλλά βελτιώνεται όσο
περισσότερα ιδιοδιανύσματα χρησιμοποιηθούν.

\section{Εύρεση όμοιων αντικειμένων/επιστρώσεων}
\label{recognition}
Να σημειωθεί ότι αυτό το κομμάτι της εργασίας δεν ολοκληρώθηκε με επιτυχία.
Παρακάτω παρατίθεται η διαδικασία που βρέθηκε ότι πιθανώς να λειτουργεί όμως αυτό δεν
είναι επιβεβαιωμένο.

Για την εύρεση όμοιων αντικειμένων θα χρησιμοποιηθούν αυτή τη φορά οι ιδιοτιμές
των μοντέλων, όπως αυτές προκύπτουν από την ανάλυση ιδιοδιανυσμάτων ενός γεωμετρικού
πίνακα Laplace (geometric Laplacian).
Μια και θα γίνει σύγκριση των μοντέλων για να βρεθούν ομοιότητες ανάμεσα στα σχήματά τους,
οι ιδιοτιμές ενδιαφέροντος είναι αυτές που αφορούν τις χαμηλές συχνότητες
και άρα χαρακτηρίζουν το γενικό σχήμα του μοντέλου. Χρησιμοποιώντας αυτές τις τιμές
μπορούμε να κατασκευάσουμε μια "ταυτότητα" για τα διάφορα σχήματα που έχουν τα
μοντέλα αναφοράς.
Συγκρίνοντας στη συνέχεια αυτή την "ταυτότητα" μπορούμε να αναγνωρίσουμε,
σε κάποιο βαθμό εμπιστοσύνης,
αν δύο μοντέλα έχουν όμοιο σχήμα και άρα να τα κατατάξουμε στην ίδια κατηγορία.

Για να επιτευχθεί η παραπάνω διαδικασία, χρησιμοποιείται ο τύπος

\[
	Dist(P, Q) = {
		\frac {1} {2}
		\sum^{k}_{i=1} {
			\frac
			{
				\Big[
					|\lambda^{P}_{i}|^{\frac{1}{2}} - |\lambda^{Q}_{i}|^{\frac{1}{2}}
				\Big]^2
			}
			{
				|\lambda^{P}_{i}|^{\frac{1}{2}} + |\lambda^{Q}_{i}|^{\frac{1}{2}}
			}
		}
	}
\]

\noindent
όπου $\lambda_{i}$ η ιδιοτιμή $i$ του κάθε μοντέλου

Ο τύπος αυτός μας επιστρέφει μια τιμή που επιδεικνύει πόσο πολύ διαφέρει το μοντέλο
$P$ από το μοντέλο $Q$. Όσο πιο μικρή αυτή η τιμή τόσο πιο όμοια τα δύο μοντέλα.

Για το περιορισμό του υπολογιστικού κόστους αυτής της διαδικασίας χρησιμοποιούνται μόνο
τα $k$ πρώτα ιδιοδιανύσματα των δύο μοντέλων. Στην έρευνα που διεξήχθηκε βρέθηκε ότι
$k=20$ είναι μια καλή τιμή για την αναγνώριση ομοίων αντικειμένων.

Με παρόμοιο τρόπο, θεωρητικά, είναι δυνατόν να συγκριθούν τα μοντέλα με βάση τις
επιφανειακές τους λεπτομέρειες. Σε αυτή την περίπτωση οι ιδιοτιμές που θα χρησιμοποιηθούν
θα είναι οι υψίσυχνες, όμως η υπόλοιπη διαδικασία θα παραμείνει ίδια.


\section{Οδηγίες χρήσης του προγράμματος}
Στο πρώτο μέρος της εργασίας (μέχρι το κομμάτι της εξομάλυνσης του μοντέλου)
αντιστοιχεί το αρχείο GUI.py στο οποίο υπάρχει δυνατότητα φόρτωσης οποιουδήποτε
μοντέλου από την μπάρα στο πάνω μέρος του παραθύρου και στη συνέχεια πατώντας
κάποιους χαρακτήρες στο πληκτρολόγιο μπορούν να εκτελεστούν οι διάφορες
λειτουργίες που έχουν αναφερθεί

Συγκεκριμένα οι λειτουργίες και τα αντίστοιχα κουμπιά είναι τα εξής:

\begin{itemize}
	\item R -> Επαναφορά μοντέλου στην αρχική κατάσταση
	\item S -> Εξομάλυνση μοντέλου (χρησιμοποιώντας τη μέθοδο που αναφέρθηκε
		στην ενότητα \ref{smoothing})
	\item G -> Εφαρμογή θορύβου στο μοντέλο (Gaussian noise)
	\item P -> Εφαρμογή θορύβου στο μοντέλο (Perlin noise)
	\item V -> Οπτικοποίηση επιρροής ιδιοδιανυσμάτος
	\item Πάνω βέλος -> Επιλογή ιδιοδιανύσματος με ψηλότερη συχνότητα από το
		προηγούμενο για την οπτικοποίηση
	\item Κάτω βέλος -> Επιλογή ιδιοδιανύσματος με χαμηλότερη συχνότητα από το
		προηγούμενο για την οπτικοποίηση
	\item Αριστερό βέλος -> Επιλογή ιδιοδιανύσματος με τη χαμηλότερη συχνότητα
		για την οπτικοποίηση
	\item Δεξί βέλος -> Επιλογή ιδιοδιανύσματος με την υψηλότερη συχνότητα
		για την οπτικοποίηση
\end{itemize}

Στο δεύτερο μέρος της εργασίας (Εύρεση ομοίων αντικειμένων/επιστρώσεων)
αντιστοιχεί το αρχείο shape\_recognition.py στο οποίο έχει γίνει μια
πρώτη εργασία προκειμένου να επιτευχθεί ο σκοπός αυτού του μέρους, όμως
όπως αναφέρθηκε και στην ενότητα \ref{recognition} δεν ήταν δυνατή η
ολοκλήρωση του.

\nocite{*}
\printbibliography[
	heading=bibintoc,
	title={References}
]

\end{document}
